{% extends 'base.html' %}
{% load common_tags %}
{% load urs_tags %}
{% block section %}
<style>
   .right {
   padding-top: 50px;
   float: right;
   width: 300px;
   border: 3px solid #73AD21;
   padding: 10px;
   }
</style>
<div> </div>
{% endblock %}
<!-- Content Header (Page header) -->
<!--<style>
   form {
   margin: 0 auto;
   width:450px;
   }
   </style>-->
<!-- Main content -->
{% block content %}
<div class="clear"></div>
<section class="content-part">
<div class='container'>
   <div class="white-box" >
      <div class="col-md-12">
         <h3 class="border_line"> </h3>
         <br>
      </div>

      <form autocomplete="off" id="report" class ="form-horizantal budget_form" action="/report/section-form/" method="POST" enctype="multipart/form-data">
         {% csrf_token %}
         {% if block1 %}
         <div class="col-md-12">
            <div class = "block_name"><h3 class="border_line">{{block1.name}}</h3>
            <br>
            <input type="hidden" name="project_slug" value="{{project_slug}}" id="{{project_slug}}">

            <input type="hidden" name="report_id" value="{{report_id}}" id="{{report_id}}">
             
             <div class="row {{block1.slug}}">
                {% get_questions block1 project_report as ques %}
                            {% for i in ques %}
                                <div class="col-md-6 nopadding">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            {% if i.q_type == 'OT' %}
                                                {% get_auto_populated_questions i.q_id  project project_report as sub_questions %}
                                                    {% for sub in sub_questions %}
                                                    <div class="col-md-6 nopadding">
                                                        <div class="col-md-12">
                                                            <div class="form-group">
                                                             <label>{{sub.q_text}}<font color="red">*</font></label> 
                                                                {% if sub.q_type == 'APT' %}
                                                                    <input type = 'text' name = "{{sub.q_name}}_{{sub.q_id}}" value = "{{sub.answer}}"></input>
                                                                {% elif sub.q_type == 'API' %}
                                                                    <img src="{{sub.answer}}"  alt="" title="" height='117px' width = '100px' />
                                                                    <input type="file" name= "{{sub.q_name}}_{{sub.q_id}}" ></input>
                                                                    <img src="/static/img/new-logo.png" alt="" title="Good CSR PMU" />
                                                                {% endif %}
                                                                </div>
                                                        </div>
                                                    </div>
                                                    {% endfor %}
                                            {% else %}
                                                <label>{{i.q_text}}<font color="red">*</font></label>
                                                {% if i.q_type == 'T' %}
                                                    <input type="text" name="{{i.q_name}}_{{i.q_id}}" id="{{i.q_name}}_{{i.q_id}}" value = "{{i.answer}}" required="" ></input>
                                                {% elif i.q_type == 'F' %}
                                                    <input type = "file" name= "{{i.q_name}}_{{i.q_id}}" id = "{{i.q_name}}_{{i.q_id}}" value = "{{i.answer}}"></input>
                                                    <img src="{{image_url}}{{i.answer}}"  alt="" title="" height='117px' width = '100px'>
                                                {% endif %}
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                    </div>
         </div>
         <input class="btn btn-primary" name = 'cover_image_save' type="submit" value="Save" onclick="return ddlValidate();" />
         {% endif %}
         </form>
         
<form autocomplete="off" id="report" class ="form-horizantal budget_form" action="/report/section-form/" method="POST" enctype="multipart/form-data">
         {% csrf_token %}
         {% if block2 %}
         <div class="col-md-12">
            <div class = "block_name"><h3 class="border_line"><br>{{block2.name}}</h3>
            <br>
            <input type="hidden" name="project_slug" value="{{project_slug}}" id="{{project_slug}}">

            <input type="hidden" name="report_id" value="{{report_id}}" id="{{report_id}}">
             
             <div class="row {{block2.slug}}">
                {% get_questions block2 project_report as ques %}
                            {% for i in ques %}
                                <div class="col-md-6 nopadding">
                                    <div class="col-md-12">
                                        <div class="form-group">
                                            {% if i.q_type == 'OT' %}
                                                {% get_auto_populated_questions i.q_id project project_report as sub_questions %}
                                                    {% for sub in sub_questions %}
                                                    <div class="col-md-6 nopadding">
                                                        <div class="col-md-12">
                                                            <div class="form-group">
                                                             <label>{{sub.q_text}}<font color="red">*</font></label> 
                                                                {% if sub.q_type == 'APT' %}
                                                                    <input type = 'text' name = "{{sub.q_name}}_{{sub.q_id}}" value = "{{sub.answer}}" readonly=""></input>
                                                                {% elif sub.q_type == 'API' %}
                                                                    <img src="{{sub.answer}}"  alt="" title="" height='117px' width = '100px' />
                                                                    <input type="file" name= "{{sub.q_name}}_{{sub.q_id}}" ></input>
                                                                    <img src="/static/img/new-logo.png" alt="" title="Good CSR PMU" />
                                                                {% endif %}
                                                                </div>
                                                        </div>
                                                    </div>
                                                    {% endfor %}
                                            {% else %}
                                                <label>{{i.q_text}}<font color="red">*</font></label>
                                                {% if i.q_type == 'T' %}
                                                    <input type="text" name="{{i.q_name}}_{{i.q_id}}" id="{{i.q_name}}_{{i.q_id}}" value = "{{i.answer}}" required=""></input>
                                                {% elif i.q_type == 'F' %}
                                                    <input type = "file" name= "{{i.q_name}}_{{i.q_id}}" id = "{{i.q_name}}_{{i.q_id}}" value = "{{i.answer}}"></input>
                                                    <img src="{{image_url}}{{i.answer}}"  alt="" title="" height='117px' width = '100px'>
                                                {% endif %}
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                    </div>
         </div>
         <input class="btn btn-primary" name = 'summary_sheet' type="submit" value="Save" onclick="return ddlValidate();" />
        {% endif %}

         
<!--          <input class="btn btn-primary" name = 'quarter_updates' type="submit" value="Save and Generate Quarter Updates" onclick="return ddlValidate();" />-->
<!--         <input class="btn btn-primary" name = 'report_save' type="submit" value="Save" onclick="return ddlValidate();" />-->
         <a class="btn btn-success" href="/project/summary/?slug={{project_slug}}&key=summary"">Back</button></a>
         </form>
   </div>

</div>



<script src="http://code.jquery.com/jquery-migrate-1.0.0.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script src="https://rawgit.com/Pixabay/jQuery-tagEditor/master/jquery.caret.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="https://rawgit.com/Pixabay/jQuery-tagEditor/master/jquery.tag-editor.js"></script>
<link rel="stylesheet" href="https://rawgit.com/Pixabay/jQuery-tagEditor/master/jquery.tag-editor.css">
<script>
   $(document).ready(function() {
     $("#id_start_date").datepicker({dateFormat: 'yy-mm-dd',changeMonth: true,changeYear: true });
     $("#id_end_date").datepicker({ dateFormat: 'yy-mm-dd',changeMonth: true,changeYear: true });
     var start_date = "{{project.start_date|date:'Y-m-d'}}"
     if (start_date != ''){
         document.getElementById("id_start_date").value = start_date
         $("#id_start_date").datepicker({dateFormat: 'yy-mm-dd',minDate: start_date,changeMonth: true,changeYear: true });
     }
   } );
</script>

<script>
   $(document).ready(function() {
        $("input[type='image']").click(function() {
    $("input[id='my_file']").click();
});
    });
   });
</script>
{% endblock %}
