{% extends 'base.html' %}
{% block section %}
<div></div>
{% endblock %}
{% block content %}
<!--<link href="static/css/multiselect.css" media="screen" rel="stylesheet" type="text/css">-->
    <!-- Content Header (Page header) -->
<style>
    .error,.errorlist { color :red;}
    #date_error,#min_max {color : red;}
</style>

    <!-- Main content -->

<section class="content-part">
	<div class="row">
	
    <form class="form-horizantal budget_form" action="{{request.path}}" method='POST' enctype="multipart/form-data">{% csrf_token %}
     <div class="col-md-12">
                   <h3 class="border_line">Upload Images</h3>
                  
        </div>
       <div class="col-md-6 nopadding">
            <form action="{{request.path}}" method='POST' enctype="multipart/form-data">{% csrf_token %}
                    {% for field in form %}
                         {{form.media}}
                        <div class="col-md-12">
                            <div class="form-group">
                                
                                <label>{{field.label_tag}}</label>
                                {{field}}
                                {{field.errors}}
                            </div>
                        </div>
                    {% endfor %}
            <input id = 'slug' name = 'slug' type='hidden' value = "{{project.slug}}"/>
           <div class="col-md-12">
                <div class="form-group">
              <input class="budget_button" type="submit" value="Save" onclick="return RemoveProduct();" />
              <a class="btn btn-success" href="/project/summary/?slug={{project.slug}}" style="margin-right:5px;float: right;">Back</button></a>
           </div>
           </div>
        </div>
    </form>
    
    
    
    </div>
</section>

{% endblock %}

  {% block script %}
<script src="/static/js/jquery.quicksearch.js"></script>
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
<script src="/static/js/jquery.quicksearch.js"></script>
<script src = "/static/js/jquery.multi-select.js"></script>

<script>
    $(document).ready(function() {
        $( "#id_date" ).datepicker({ dateFormat: 'yy-mm-dd' });
        $( "#id_end_date" ).datepicker({ dateFormat: 'yy-mm-dd' });
        $( "#id_actual_start_date" ).datepicker({ dateFormat: 'yy-mm-dd' });
        $( "#id_actual_end_date" ).datepicker({ dateFormat: 'yy-mm-dd' });
       // $( "#id_overdue" ).datepicker({ dateFormat: 'yy-mm-dd' });
    });
</script>

<script>
    $(document).ready(function() {
    if ('{{model_name}}' == 'Milestone'){
    $('#id_task').on('click',function(e){
        var tasks_ids = $('#id_task').val();
        $.ajax({
            url:'/managing/milestone/overdue/',
            type:'GET',
            data:{'id':tasks_ids},
            dataType:"json",
            success:function(data){
            if (data.milestone_overdue_date != ""){
                document.getElementById("id_overdue").value = data.milestone_overdue_date;
             }
            else{
                $( "#id_overdue_date" ).datepicker({ dateFormat: 'yy-mm-dd' });
                }
            },
            error : function(){}
        });
        e.stopImmediatePropagation();
        return false;
      });
    }
    });
</script>

<script>
    $(document).ready(function() {
    $('#id_activity').on('change',function(e){
        
        var select_id = $('#id_activity').val();
        $.ajax({
            url:'/managing/task/dependencies/',
            type:'GET',
            data:{id:select_id},
            dataType:"json",
            success:function(data){
                if (data.project_start_date != ""){
                    document.getElementById("id_start_date").value = data.project_start_date;
                 }
                else{
                    $( "#id_start_date" ).datepicker({ dateFormat: 'yy-mm-dd' });
                    }
                //document.getElementById("id_task_dependency").value = data.tasks_dependency;
                $('#id_task_dependency')
                    .find('option')
                    .remove()
                    for(var i=0;i<data.tasks_dependency.length;i++){
                        
                        $('#id_task_dependency').append('<option value='+data.tasks_dependency[i]['id']+'>'+data.tasks_dependency[i]['name']+'</option>')
                        }
            },
            error : function(){}
        });
        e.stopImmediatePropagation();
        return false;
      });
    });
</script>



{% endblock %}
